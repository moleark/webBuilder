{"version":3,"sources":["../../../src/entry/tools.tsx","../node_modules/tonva/dist/img/logo.svg","../../../src/entry/register.tsx"],"names":["module","exports"],"mappings":"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","file":"static/js/0.ded41370.chunk.js","sourcesContent":["import * as React from 'react';\r\nimport { nav, mobileRegex, emailRegex } from '../components';\r\nvar logo = require('../img/logo.svg');\r\nexport function tonvaTop() {\r\n    return nav.loginTop(React.createElement(\"div\", { className: \"d-flex align-items-center position-relative\" },\r\n        React.createElement(\"img\", { className: \"App-logo h-3c position-absolute\", src: logo, alt: \"img\" }),\r\n        React.createElement(\"div\", { className: \"h3 flex-fill text-center\" },\r\n            React.createElement(\"span\", { className: \"text-primary mr-3\" }, \"\\u540C\"),\r\n            React.createElement(\"span\", { className: \"text-danger\" }, \"\\u82B1\"))));\r\n}\r\nvar senders = [\r\n    { type: 'mobile', caption: '手机号', regex: mobileRegex },\r\n    { type: 'email', caption: '邮箱', regex: emailRegex }\r\n];\r\nexport function getSender(un) {\r\n    var sender = senders.find(function (v) { return v.regex.test(un) === true; });\r\n    return sender;\r\n}\r\n//# sourceMappingURL=tools.js.map","module.exports = __webpack_public_path__ + \"static/media/logo.ee7cd8ed.svg\";","var __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nimport * as React from 'react';\r\nimport { nav, Page, Form, resLang } from '../components';\r\nimport { Controller, VPage } from '../vm';\r\nimport { userApi } from '../net';\r\nimport '../css/va-form.css';\r\nimport { registerRes } from '../res';\r\nimport { tonvaTop, getSender } from './tools';\r\n/*\r\nclass AccountInput extends TextWidget {\r\n    @observable private buttonDisabled: boolean = true;\r\n    private onClick = () => {\r\n        let {onButtonClick} = this.context.form.props;\r\n        if (onButtonClick === undefined) return;\r\n        onButtonClick(this.name, this.context);\r\n    }\r\n    protected onChange(evt: React.ChangeEvent<any>) {\r\n        this.buttonDisabled = (evt.target.value.trim().length === 0);\r\n    }\r\n    render() {\r\n        return <>\r\n            <div className=\"input-group\">\r\n                <input ref={input=>this.input = input}\r\n                            className=\"form-control\"\r\n                            type={this.inputType}\r\n                            defaultValue={this.value}\r\n                            onChange={(evt: React.ChangeEvent<any>) => this.onChange(evt)}\r\n                            placeholder='手机号/邮箱'\r\n                            readOnly={this.readOnly}\r\n                            disabled={this.disabled}\r\n                            onKeyDown = {this.onKeyDown}\r\n                            onFocus = {(evt: React.FocusEvent<any>) => this.onFocus(evt)}\r\n                            onBlur={(evt: React.FocusEvent<any>) => this.onBlur(evt)}\r\n                            maxLength={(this.itemSchema as StringSchema).maxLength} />\r\n                <div className=\"input-group-append\">\r\n                    <button className=\"btn btn-sm btn-outline-primary\"\r\n                        type=\"button\" disabled={this.buttonDisabled}\r\n                        onClick={this.onClick}>\r\n                        <small>发送验证码</small>\r\n                    </button>\r\n                </div>\r\n            </div>\r\n            {this.renderErrors()}\r\n        </>;\r\n    }\r\n}\r\n*/\r\nvar RegisterController = /** @class */ (function (_super) {\r\n    __extends(RegisterController, _super);\r\n    function RegisterController() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.accountPageCaption = '注册账号';\r\n        _this.accountLabel = '注册账号';\r\n        _this.accountSubmitCaption = '注册新账号';\r\n        _this.passwordPageCaption = '账号密码';\r\n        _this.passwordSubmitCaption = '注册新账号';\r\n        _this.successText = '注册成功';\r\n        _this.login = function (account) { return __awaiter(_this, void 0, void 0, function () {\r\n            var retUser;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0: return [4 /*yield*/, userApi.login({ user: account || this.account, pwd: this.password, guest: nav.guest })];\r\n                    case 1:\r\n                        retUser = _a.sent();\r\n                        if (retUser === undefined) {\r\n                            alert('something wrong!');\r\n                            return [2 /*return*/];\r\n                        }\r\n                        return [4 /*yield*/, nav.userLogined(retUser)];\r\n                    case 2:\r\n                        _a.sent();\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        }); };\r\n        return _this;\r\n    }\r\n    RegisterController.prototype.internalStart = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                this.openVPage(AccountPage);\r\n                return [2 /*return*/];\r\n            });\r\n        });\r\n    };\r\n    RegisterController.prototype.toVerify = function (account) {\r\n        this.account = account;\r\n        this.openVPage(VerifyPage);\r\n    };\r\n    RegisterController.prototype.toPassword = function () {\r\n        this.openVPage(PasswordPage);\r\n    };\r\n    RegisterController.prototype.toSuccess = function (accounts) {\r\n        this.openVPage(RegSuccess, accounts);\r\n    };\r\n    RegisterController.prototype.regReturn = function (registerReturn) {\r\n        var msg;\r\n        switch (registerReturn) {\r\n            default:\r\n                return '服务器发生错误';\r\n            case 4:\r\n                return '验证码错误';\r\n            case 0:\r\n                return;\r\n            case 1:\r\n                msg = '用户名 ' + this.account;\r\n                break;\r\n            case 2:\r\n                msg = '手机号 +' + this.account;\r\n                break;\r\n            case 3:\r\n                msg = '邮箱 ' + this.account;\r\n                break;\r\n        }\r\n        return msg + ' 已经被注册过了';\r\n    };\r\n    RegisterController.prototype.checkAccount = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var ret, error;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0: return [4 /*yield*/, userApi.isExists(this.account)];\r\n                    case 1:\r\n                        ret = _a.sent();\r\n                        error = this.accountError(ret);\r\n                        if (error !== undefined)\r\n                            return [2 /*return*/, error];\r\n                        return [4 /*yield*/, userApi.sendVerify(this.account, this.type, nav.oem)];\r\n                    case 2:\r\n                        ret = _a.sent();\r\n                        this.toVerify(this.account);\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    RegisterController.prototype.accountError = function (isExists) {\r\n        if (isExists > 0)\r\n            return '已经被注册使用了';\r\n    };\r\n    RegisterController.prototype.execute = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var params, ret, error;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        params = {\r\n                            nick: undefined,\r\n                            user: this.account,\r\n                            pwd: this.password,\r\n                            country: undefined,\r\n                            mobile: undefined,\r\n                            mobileCountry: undefined,\r\n                            email: undefined,\r\n                            verify: this.verify\r\n                        };\r\n                        switch (this.type) {\r\n                            case 'mobile':\r\n                                params.mobile = Number(this.account);\r\n                                params.mobileCountry = 86;\r\n                                break;\r\n                            case 'email':\r\n                                params.email = this.account;\r\n                                break;\r\n                        }\r\n                        return [4 /*yield*/, userApi.register(params)];\r\n                    case 1:\r\n                        ret = _a.sent();\r\n                        if (ret === 0) {\r\n                            nav.clear();\r\n                            this.toSuccess();\r\n                            return [2 /*return*/];\r\n                        }\r\n                        error = this.regReturn(ret);\r\n                        return [2 /*return*/, error];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    return RegisterController;\r\n}(Controller));\r\nexport { RegisterController };\r\nvar ForgetController = /** @class */ (function (_super) {\r\n    __extends(ForgetController, _super);\r\n    function ForgetController() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.accountPageCaption = '密码找回';\r\n        _this.accountLabel = '账号';\r\n        _this.accountSubmitCaption = '注册新账号';\r\n        _this.passwordPageCaption = '重置密码';\r\n        _this.passwordSubmitCaption = '提交';\r\n        _this.successText = '成功修改密码';\r\n        return _this;\r\n    }\r\n    ForgetController.prototype.execute = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var ret;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0: return [4 /*yield*/, userApi.resetPassword(this.account, this.password, this.verify, this.type)];\r\n                    case 1:\r\n                        ret = _a.sent();\r\n                        nav.clear();\r\n                        this.toSuccess(ret);\r\n                        return [2 /*return*/, undefined];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    ForgetController.prototype.accountError = function (isExists) {\r\n        if (isExists === 0)\r\n            return '请输入正确的账号';\r\n    };\r\n    return ForgetController;\r\n}(RegisterController));\r\nexport { ForgetController };\r\nvar AccountPage = /** @class */ (function (_super) {\r\n    __extends(AccountPage, _super);\r\n    function AccountPage() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.schema = [\r\n            { name: 'user', type: 'string', required: true, maxLength: 100 },\r\n            { name: 'verify', type: 'submit' },\r\n        ];\r\n        _this.res = resLang(registerRes);\r\n        _this.page = function () {\r\n            return React.createElement(Page, { header: _this.controller.accountPageCaption },\r\n                React.createElement(\"div\", { className: \"w-max-20c my-5 py-5\", style: { marginLeft: 'auto', marginRight: 'auto' } },\r\n                    tonvaTop(),\r\n                    React.createElement(\"div\", { className: \"h-3c\" }),\r\n                    React.createElement(Form, { schema: _this.schema, uiSchema: _this.uiSchema, onButtonClick: _this.onSubmit, onEnter: _this.onEnter, requiredFlag: false }),\r\n                    nav.privacyEntry()));\r\n        };\r\n        _this.onSubmit = function (name, context) { return __awaiter(_this, void 0, void 0, function () {\r\n            var user, value, sender, type, ret;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        context.clearContextErrors();\r\n                        user = 'user';\r\n                        value = context.getValue(user);\r\n                        sender = getSender(value);\r\n                        if (sender === undefined) {\r\n                            context.setError(user, '必须是手机号或邮箱');\r\n                            return [2 /*return*/];\r\n                        }\r\n                        type = sender.type;\r\n                        if (type === 'mobile') {\r\n                            if (value.length !== 11 || value[0] !== '1') {\r\n                                context.setError(user, '请输入正确的手机号');\r\n                                return [2 /*return*/];\r\n                            }\r\n                        }\r\n                        this.controller.account = value;\r\n                        this.controller.type = type;\r\n                        return [4 /*yield*/, this.controller.checkAccount()];\r\n                    case 1:\r\n                        ret = _a.sent();\r\n                        if (ret !== undefined)\r\n                            context.setError(user, ret);\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        }); };\r\n        _this.onEnter = function (name, context) { return __awaiter(_this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        if (!(name === 'user')) return [3 /*break*/, 2];\r\n                        return [4 /*yield*/, this.onSubmit('verify', context)];\r\n                    case 1: return [2 /*return*/, _a.sent()];\r\n                    case 2: return [2 /*return*/];\r\n                }\r\n            });\r\n        }); };\r\n        return _this;\r\n    }\r\n    AccountPage.prototype.open = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                this.uiSchema = {\r\n                    items: {\r\n                        user: {\r\n                            widget: 'text',\r\n                            label: this.controller.accountLabel,\r\n                            placeholder: '手机号或邮箱',\r\n                        },\r\n                        verify: { widget: 'button', className: 'btn btn-primary btn-block mt-3', label: '发送验证码' },\r\n                    }\r\n                };\r\n                this.openPage(this.page);\r\n                return [2 /*return*/];\r\n            });\r\n        });\r\n    };\r\n    return AccountPage;\r\n}(VPage));\r\nvar VerifyPage = /** @class */ (function (_super) {\r\n    __extends(VerifyPage, _super);\r\n    function VerifyPage() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.schema = [\r\n            { name: 'verify', type: 'number', required: true, maxLength: 6 },\r\n            { name: 'submit', type: 'submit' },\r\n        ];\r\n        _this.onVerifyChanged = function (context, value, prev) {\r\n            context.setDisabled('submit', !value || (value.length !== 6));\r\n        };\r\n        _this.uiSchema = {\r\n            items: {\r\n                verify: {\r\n                    widget: 'text',\r\n                    label: '验证码',\r\n                    placeholder: '请输入验证码',\r\n                    onChanged: _this.onVerifyChanged,\r\n                },\r\n                submit: {\r\n                    widget: 'button',\r\n                    className: 'btn btn-primary btn-block mt-3',\r\n                    label: '下一步 >',\r\n                    disabled: true\r\n                },\r\n            }\r\n        };\r\n        _this.onSubmit = function (name, context) { return __awaiter(_this, void 0, void 0, function () {\r\n            var verify, ret;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        verify = this.controller.verify = context.getValue('verify');\r\n                        return [4 /*yield*/, userApi.checkVerify(this.controller.account, verify)];\r\n                    case 1:\r\n                        ret = _a.sent();\r\n                        if (ret === 0) {\r\n                            context.setError('verify', '验证码错误');\r\n                            return [2 /*return*/];\r\n                        }\r\n                        this.controller.toPassword();\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        }); };\r\n        _this.onEnter = function (name, context) { return __awaiter(_this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        if (!(name === 'verify')) return [3 /*break*/, 2];\r\n                        return [4 /*yield*/, this.onSubmit('submit', context)];\r\n                    case 1: return [2 /*return*/, _a.sent()];\r\n                    case 2: return [2 /*return*/];\r\n                }\r\n            });\r\n        }); };\r\n        _this.page = function () {\r\n            var typeText, extra;\r\n            switch (_this.controller.type) {\r\n                case 'mobile':\r\n                    typeText = '手机号';\r\n                    break;\r\n                case 'email':\r\n                    typeText = '邮箱';\r\n                    extra = React.createElement(React.Fragment, null,\r\n                        React.createElement(\"span\", { className: \"text-danger\" }, \"\\u6CE8\\u610F\"),\r\n                        \": \\u6709\\u53EF\\u80FD\\u8BEF\\u4E3A\\u5783\\u573E\\u90AE\\u4EF6\\uFF0C\\u8BF7\\u68C0\\u67E5\",\r\n                        React.createElement(\"br\", null));\r\n                    break;\r\n            }\r\n            return React.createElement(Page, { header: \"\\u9A8C\\u8BC1\\u7801\" },\r\n                React.createElement(\"div\", { className: \"w-max-20c my-5 py-5\", style: { marginLeft: 'auto', marginRight: 'auto' } },\r\n                    \"\\u9A8C\\u8BC1\\u7801\\u5DF2\\u7ECF\\u53D1\\u9001\\u5230\",\r\n                    typeText,\r\n                    React.createElement(\"br\", null),\r\n                    React.createElement(\"div\", { className: \"py-2 px-3 my-2 text-primary bg-light\" },\r\n                        React.createElement(\"b\", null, _this.controller.account)),\r\n                    extra,\r\n                    React.createElement(\"div\", { className: \"h-1c\" }),\r\n                    React.createElement(Form, { schema: _this.schema, uiSchema: _this.uiSchema, onButtonClick: _this.onSubmit, onEnter: _this.onEnter, requiredFlag: false })));\r\n        };\r\n        return _this;\r\n    }\r\n    VerifyPage.prototype.open = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                this.openPage(this.page);\r\n                return [2 /*return*/];\r\n            });\r\n        });\r\n    };\r\n    return VerifyPage;\r\n}(VPage));\r\nvar PasswordPage = /** @class */ (function (_super) {\r\n    __extends(PasswordPage, _super);\r\n    function PasswordPage() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.schema = [\r\n            { name: 'pwd', type: 'string', required: true, maxLength: 100 },\r\n            { name: 'rePwd', type: 'string', required: true, maxLength: 100 },\r\n            { name: 'submit', type: 'submit' },\r\n        ];\r\n        _this.onSubmit = function (name, context) { return __awaiter(_this, void 0, void 0, function () {\r\n            var values, pwd, rePwd, error;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        values = context.form.data;\r\n                        pwd = values.pwd, rePwd = values.rePwd;\r\n                        if (!(!pwd || pwd !== rePwd)) return [3 /*break*/, 1];\r\n                        context.setValue('pwd', '');\r\n                        context.setValue('rePwd', '');\r\n                        error = '密码错误，请重新输入密码！';\r\n                        context.setError('pwd', error);\r\n                        return [3 /*break*/, 3];\r\n                    case 1:\r\n                        this.controller.password = pwd;\r\n                        return [4 /*yield*/, this.controller.execute()];\r\n                    case 2:\r\n                        error = _a.sent();\r\n                        if (error !== undefined) {\r\n                            nav.push(React.createElement(Page, { header: \"\\u6CE8\\u518C\\u4E0D\\u6210\\u529F\" },\r\n                                React.createElement(\"div\", { className: \"p-5 text-danger\" }, error)));\r\n                        }\r\n                        _a.label = 3;\r\n                    case 3: return [2 /*return*/, error];\r\n                }\r\n            });\r\n        }); };\r\n        _this.onEnter = function (name, context) { return __awaiter(_this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        if (!(name === 'rePwd')) return [3 /*break*/, 2];\r\n                        return [4 /*yield*/, this.onSubmit('submit', context)];\r\n                    case 1: return [2 /*return*/, _a.sent()];\r\n                    case 2: return [2 /*return*/];\r\n                }\r\n            });\r\n        }); };\r\n        _this.page = function () {\r\n            return React.createElement(Page, { header: _this.controller.passwordPageCaption },\r\n                React.createElement(\"div\", { className: \"w-max-20c my-5 py-5\", style: { marginLeft: 'auto', marginRight: 'auto' } },\r\n                    \"\\u6CE8\\u518C\\u8D26\\u53F7\",\r\n                    React.createElement(\"br\", null),\r\n                    React.createElement(\"div\", { className: \"py-2 px-3 my-2 text-primary bg-light\" },\r\n                        React.createElement(\"b\", null, _this.controller.account)),\r\n                    React.createElement(\"div\", { className: \"h-1c\" }),\r\n                    React.createElement(Form, { schema: _this.schema, uiSchema: _this.uiSchema, onButtonClick: _this.onSubmit, onEnter: _this.onEnter, requiredFlag: false })));\r\n        };\r\n        return _this;\r\n    }\r\n    PasswordPage.prototype.open = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                this.uiSchema = {\r\n                    items: {\r\n                        pwd: { widget: 'password', placeholder: '密码', label: '密码' },\r\n                        rePwd: { widget: 'password', placeholder: '重复密码', label: '重复密码' },\r\n                        submit: { widget: 'button', className: 'btn btn-primary btn-block mt-3', label: this.controller.passwordSubmitCaption },\r\n                    }\r\n                };\r\n                this.openPage(this.page);\r\n                return [2 /*return*/];\r\n            });\r\n        });\r\n    };\r\n    return PasswordPage;\r\n}(VPage));\r\nvar RegSuccess = /** @class */ (function (_super) {\r\n    __extends(RegSuccess, _super);\r\n    function RegSuccess() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.page = function (_a) {\r\n            var users = _a.users;\r\n            var _b = _this.controller, account = _b.account, successText = _b.successText, login = _b.login;\r\n            if (users === undefined) {\r\n                return React.createElement(Page, { header: false },\r\n                    React.createElement(\"div\", { className: \"container w-max-30c\" },\r\n                        React.createElement(\"div\", { className: \"my-5\" },\r\n                            React.createElement(\"div\", { className: \"py-5\" },\r\n                                \"\\u8D26\\u53F7 \",\r\n                                React.createElement(\"strong\", { className: \"text-primary\" },\r\n                                    account,\r\n                                    \" \"),\r\n                                \" \",\r\n                                successText,\r\n                                \"\\uFF01\"),\r\n                            React.createElement(\"button\", { className: \"btn btn-success btn-block\", type: \"button\", onClick: function () { return login(undefined); } }, \"\\u76F4\\u63A5\\u767B\\u5F55\"))));\r\n            }\r\n            else {\r\n                return React.createElement(Page, { header: false },\r\n                    React.createElement(\"div\", { className: \"container w-max-30c\" },\r\n                        React.createElement(\"div\", { className: \"my-5\" },\r\n                            React.createElement(\"div\", { className: \"py-5 text-success\" }, successText),\r\n                            users.map(function (v) {\r\n                                var name = v.name;\r\n                                return React.createElement(\"div\", { className: \"py-2 cursor-pointer\", onClick: function () { return login(name); } },\r\n                                    \"\\u767B\\u5F55\\u8D26\\u53F7 \",\r\n                                    React.createElement(\"strong\", { className: \"text-primary\" },\r\n                                        name,\r\n                                        \" \"));\r\n                            }))));\r\n            }\r\n        };\r\n        return _this;\r\n    }\r\n    RegSuccess.prototype.open = function (users) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                this.openPage(this.page, { users: users });\r\n                return [2 /*return*/];\r\n            });\r\n        });\r\n    };\r\n    return RegSuccess;\r\n}(VPage));\r\n//# sourceMappingURL=register.js.map"],"sourceRoot":""}